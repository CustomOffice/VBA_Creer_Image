{"name":"Vba creer image","tagline":"Permet de créer une image à partir d'un graphique présent sur un onglet","body":"# VBA_Creer_Image\r\nPermet de créer une image à partir d'un graphique présent sur un onglet\t\t\r\n\r\n## Instruction\r\n- Soit créer un module dans votre projet vba et y copier/coller le code ci-dessous\r\n- Soit télécharger le module (fichier *.bas) et l'inserer dans votre projet vba\r\n\r\n##Code\r\n```bash\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n'!!!TITRE : Génère une image à partir d'un graphique                                                !!!\r\n'!!!DATE :  17.04.15                                                                                !!!\r\n'!!!                                                                                                !!!\r\n'!!!DESCRIPTION : Permet de créer une image à partir d'un graphique présent sur un onglet\t\t\t!!!\r\n'!!!                                                                                                !!!\r\n'!!!REGLES :                                                                                        !!!\r\n'!!!- utilise le nom du graphique, le nom de l'onglet                                               !!!\r\n'!!!- le chemin par défaut pour l'enregistrement de l'image est l'emplacement du fichier excel      !!!\r\n'!!!- si un chemin est spécifié, par défaut il est en absolu, c'est à dire, le chemin complet, si   !!!\r\n'!!!vous voulez utiliser le chemin en relatif, il faut forcé l'argument chemin_realtif à true       !!!\r\n'!!!- par défaut le type d'image est png, vous pouvez spécifier jpg ou gif aussi                    !!!\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n\r\nSub creer_image(nom_graph As String, nom_feuille As String, Optional chemin As String = \"\", Optional chemin_relatif As Boolean = False, Optional type_image As String = \"png\")\r\n    'déclaration des variables\r\n    Dim test_creation_image As Boolean\r\n    Dim taille As Integer\r\n    \r\n    'génère le chemin\r\n    If chemin = \"\" Then\r\n        chemin_graph = ThisWorkbook.Path & Application.PathSeparator & nom_graph & \".\" & type_image\r\n    Else\r\n        If chemin_relatif = False Then\r\n            chemin_graph = chemin & Application.PathSeparator & nom_graph & \".\" & type_image\r\n        Else\r\n            chemin_graph = ThisWorkbook.Path & Application.PathSeparator & chemin & Application.PathSeparator & nom_graph & \".\" & type_image\r\n        End If\r\n    End If\r\n    \r\n    test_creation_image = False 'quelque fois l'enregistrement bug (pas trouvé pourquoi) cette variable permet de reboucler la création de l'image jusqu'à son bon fonctionnement\r\n    Do Until test_creation_image = True\r\n        Worksheets(nom_feuille).Select\r\n        ActiveWindow.Zoom = 100 'fige le zoom car influence la taille de l'image à l'enregistrement\r\n        Worksheets(nom_feuille).ChartObjects(nom_graph).Chart.Export _\r\n            Filename:=chemin_graph, FilterName:=type_image\r\n        taille = FileLen(chemin_graph)\r\n        If taille < 100 Then\r\n            test_creation_image = False\r\n            Worksheets(nom_feuille).ChartObjects(nom_graph).Select\r\n        Else\r\n            test_creation_image = True\r\n        End If\r\n    Loop\r\nEnd Sub\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}